<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        <!-- Import CSS Bootstrap -->
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
        <!-- Import custom CSS -->
        <link rel="stylesheet" type="text/css" href="/css/style-mainpage.css">
        <link rel="stylesheet" type="text/css" href="/css/style-shop.css">
        <link rel="stylesheet" type="text/css" href="/css/style-navbar.css">

        <title>Strange Day</title>
    </head>
 
    <body>
        <header>
            <%- include('navbar') %>
        </header>
        <main class="py-5 mt-3">
            <%- include('jumbo') %>
            <div class="mainpage-content shadow">
                <div class="left-pannel col-3">
                    <img class="" src="/img/img1.jpg">
                    <img class="" src="/img/img2.jpg">
                </div>
                <div class="midleft-pannel col-6 col-md-3">
                    <img class="" src="/img/img4.jpg">
                    <img class="" src="/img/img3.jpg">
                </div>
                <div class="midright-pannel col-6 col-md-3">
                    <img class="" src="/img/img1.jpg">
                    <img class="" src="/img/img4.jpg">
                    <img class="" src="/img/img3.jpg">
                </div> 
                <div class="right-pannel col-3">
                    <img class="" src="/img/img2.jpg">
                    <img class="" src="/img/img3.jpg">
                    <img class="" src="/img/img4.jpg">
                </div>
                <img class="logo" src="/img/logoSD2.png">
            </div>

            <!------ caché dans que pas scroll -->
            <div class="hidden-shop pt-3">
                <div class="head-title my-5">
                    <h1> Tous les produits </h1>
                </div>
                <div class="container product-list">
                    <% for (product of products) { %>
                        <div class="product col-md-4 p-5">
                            <div class="product-img text-center">
                                <a class="product-img" href="/product/<%= product.id %>">
                                    <img class="w-100" src="/img/<%= product.cover_image %>">
                                </a>
                            </div>
                            <div class="product-name p-2">
                                <div class="container text-center">
                                    <a class="name w-100" href="/product/<%= product.id %>"><%= product.name %></a>
                                    <div class="w-100"></div>
                                    <% if (product.collection != 'Aucune') { %>
                                        <span class="collection w-100"><%= product.collection %></span>
                                        <div class="w-100"></div>
                                    <% } %>
                                    <span class="price w-100"><%= product.price %>€</span>
                                </div>
                            </div>
                        </div>
                    <% } %>
                </div>                
            </div>
        </main>
        <footer>
            <%- include('footer') %>
        </footer>
    </body>

    <script type="text/javascript">
        const options = {
            threshold: 0.15
        }

        const callback = function (entries) {
            entries.forEach(function (entry) {
                console.log(entry.intersectionRatio)
                if (entry.intersectionRatio >= 0.15) {
                    console.log('appear')
                    $('.hidden-shop').removeClass("hidden");
                } else {
                    console.log('disappear')
                    $('.hidden-shop').addClass("hidden");
                }
            });
        }

        const observer = new IntersectionObserver(callback, options);

        $('.hidden-shop').each( function(index) {
            observer.observe(this)
        });
    </script>
</html>